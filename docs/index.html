<!DOCTYPE html>

<html>
<head>
<title>Go; Design for change</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>@import url('https://fonts.googleapis.com/css?family=Inconsolata|Source+Sans+Pro');
html, body {
font-family: 'Source Sans Pro', sans-serif;
margin: 0 0;
padding: 0 0;
}
.slide {
margin: 0 0;
padding: 0 0;
text-align: center;
height: 100vh;
}
.slide header {
display: block;
border: 1px solid #cde9e9;
margin: 0 0;
background-color: #cde9e9;
vertical-align: center;
height: 10%;
}
.slide .content {
margin: 0 0;
padding: 1% 1%;
height: 80%;
overflow: auto;
}
.slide ul, p, pre {
text-align: left;
}
.slide nav {
display: block;
margin: 0 0;
padding: 0 0;
text-align: center;
clear: both;
width: 100%;
height: 5%;
}
.slide nav ul {
list-style-type: none;
margin: 0 0;
padding: 0 0;
text-align: center;
}
.slide nav ul li {
margin: 0 1px;
display: inline;
}
.slide nav ul li.current a, .slide nav ul li:hover a {
background-color: #e2e2e2;
border-radius: 5px;
}
nav a:link, nav a:visited {
color: #727272;
padding: 3px 5px;
text-decoration: none;
cursor: pointer;
}
a:link, a:visited {
color: #007d9c;
text-decoration: none;
}
a:hover {
text-decoration: underline;
}
.header {
width: 100%;
border-bottom: 1px solid #727272;
text-align: right;
margin-top: -2em;
margin-bottom: 1em;
}
h1, h2, h3 {
text-align: center;
}
.twocolumn {
width: 100%;
}
.srcfile {
margin-top: 1.6em;
margin-bottom: 1.6em;
background-image: url("printout-whole.png");
background-repeat: repeat-y;
padding-left: 36px;
background-color: #fafafa;
tab-size: 4;
-moz-tab-size: 4;
min-width: 35vw;
}
.srcfile code {
padding: .6em 0 2vh 0;
background-image: url("printout-whole.png");
background-repeat: repeat-y;
background-position: right top;
display: block;
text-align: left;
font-family: Inconsolata;
overflow: wrap;
}
.srcfile code .line {
display: block;
width: 98%;
clear: both;
margin-bottom: -1.5vh;
}
.srcfile code span:hover {
background-color: #b4eeb4;
}
.srcfile code i {
font-style: normal;
color: #a2a2a2;
}
li.h3 {
margin-left: 2em;
}
.shell {
padding: 1em;
border-radius: 10px;
min-width: 40vw;
overflow: wrap;
}
.dark {
background-color: #2e2e34;
color: aliceblue;
}
.light {
background-color: #ffffff;
color: #3b2616;
}
img.center {
display: block;
margin-left: auto;
margin-right: auto;
}
img.left {
float: left;
margin-right: 2em;
}
.group {
text-align: left;
margin-right: 3em;
}
.group:first-child {
margin-left: 5vw;
}
td {
vertical-align: top;
}
td:nth-child(2) {
padding-left: 2em;
}
.keyword {
color: darkviolet;
}
.type {
color: dodgerblue;
}
.comment, .comment>span {
color: darkgreen;
}
</style>
</head>
<body>
<div class="slide" id="1"><header><h2>Go; Design for change</h2>
</header>
<div class="content"><a href="#2"><img src="evotalk.png"/></a><br/><br/><br/><span>Gregory Vinčić, 2023</span><br/><br/><br/></div>
<nav><ul>
<li class="current"><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
<li><a href="#4">4</a></li>
<li><a href="#5">5</a></li>
<li><a href="#6">6</a></li>
</ul>
</nav>
</div>
<div class="slide" id="2"><header><h2>Story</h2>
</header>
<div class="content"><img src="people.png"/><p>From the simplest "func main" to a large service. What choices to
consider when your project grows and how to keep it on track for
future changes.

We begin with hello world and then evolve it along a story path.
Along the way depending on the choices we make, the <b>design</b> of our
project will change. <em>I'll refer to directory layout, not as structure
but as design.</em>
</p>
</div>
<nav><ul>
<li><a href="#1">1</a></li>
<li class="current"><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
<li><a href="#4">4</a></li>
<li><a href="#5">5</a></li>
<li><a href="#6">6</a></li>
</ul>
</nav>
</div>
<div class="slide" id="3"><header><h2>func main()</h2>
</header>
<div class="content"><p>Let's kick off our project. We'll name it "rebel" and use the repository domain
"github.com/preferit/rebel".

We choose to create a command, ie. package main. The implications for
our ability to evolve
</p>
<ol>
<li>You Cannot share any logic within it with others (including
yourself), Go disallows the import of main packages</li>
<li>API documentation is hidden when using e.g. go doc, as a result of
(1)</li>
</ol>
<pre class="shell dark">$ tree rebel<br/>rebel
├── go.mod
└── main.go

0 directories, 2 files
</pre><div class="srcfile"><pre><code><span class=line><i>  1</i> <span class="comment">// Command rebel generates rebelious statement.</span></span>
<span class=line><i>  2</i> package main</span>
<span class=line><i>  3</i> </span>
<span class=line><i>  4</i> <span class="keyword">import</span> "fmt"</span>
<span class=line><i>  5</i> </span>
<span class=line><i>  6</i> <span class="keyword">func</span> main() {</span>
<span class=line><i>  7</i>     Shout()</span>
<span class=line><i>  8</i> }</span>
<span class=line><i>  9</i> </span>
<span class=line><i> 10</i> <span class="comment">// Shout writes a statement to <span class="type">os.Stdout</span></span></span>
<span class=line><i> 11</i> <span class="keyword">func</span> Shout() {</span>
<span class=line><i> 12</i>     fmt.Println("We are Rebelz!")</span>
<span class=line><i> 13</i> }</span>
<span class=line><i> 14</i> </span></code></pre></div>
</div>
<nav><ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li class="current"><a href="#3">3</a></li>
<li><a href="#4">4</a></li>
<li><a href="#5">5</a></li>
<li><a href="#6">6</a></li>
</ul>
</nav>
</div>
<div class="slide" id="4"><header><h2>You code along..</h2>
</header>
<div class="content"><p>This is a starting point; you have no intention to share
        any logic you only want to use the command yourself. You are
        happy and code along the nice feature of randomizing rebelious
        statements.</p>
<table>
<tr><td><div class="srcfile"><pre><code><span class=line><i>  1</i> <span class="comment">// Command rebel generates rebelious statement.</span></span>
<span class=line><i>  2</i> package main</span>
<span class=line><i>  3</i> </span>
<span class=line><i>  4</i> <span class="keyword">import</span> (</span>
<span class=line><i>  5</i>     "fmt"</span>
<span class=line><i>  6</i>     "math/rand"</span>
<span class=line><i>  7</i> )</span>
<span class=line><i>  8</i> </span>
<span class=line><i>  9</i> <span class="keyword">func</span> main() {</span>
<span class=line><i> 10</i>     Shout()</span>
<span class=line><i> 11</i> }</span>
<span class=line><i> 12</i> </span>
<span class=line><i> 13</i> <span class="comment">// Shout writes a statement to <span class="type">os.Stdout</span></span></span>
<span class=line><i> 14</i> <span class="keyword">func</span> Shout() {</span>
<span class=line><i> 15</i>     fmt.Println(RandValue(phrases))</span>
<span class=line><i> 16</i> }</span>
<span class=line><i> 17</i> </span>
<span class=line><i> 18</i> <span class="comment">// RandValue returns a random element of the given slice or the zero value.</span></span>
<span class=line><i> 19</i> <span class="keyword">func</span> RandValue[T any](slice []T) (v T) {</span>
<span class=line><i> 20</i>     <span class="keyword">if</span> len(slice) == 0 {</span>
<span class=line><i> 21</i>         <span class="keyword">return</span></span>
<span class=line><i> 22</i>     }</span>
<span class=line><i> 23</i>     i := rand.Intn(len(slice))</span>
<span class=line><i> 24</i>     <span class="keyword">return</span> slice[i]</span>
<span class=line><i> 25</i> }</span>
<span class=line><i> 26</i> </span>
<span class=line><i> 27</i> <span class="keyword">var</span> phrases = []string{</span>
<span class=line><i> 28</i>     "We are Rebelz!",</span>
<span class=line><i> 29</i>     "You may take our lives, but you will never take our freeeedooooom!",</span>
<span class=line><i> 30</i>     "We ain't gonna take it, No!, we ain't gonna take it!",</span>
<span class=line><i> 31</i> }</span>
<span class=line><i> 32</i> </span></code></pre></div>
</td><td><pre class="shell dark">$ tree rebel<br/>rebel
├── go.mod
└── main.go

0 directories, 2 files
</pre><p>At this point your coworkers Max and Lisa see
                    the work and you end up in a discussion;</p>
</td></tr>
</table>
</div>
<nav><ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
<li class="current"><a href="#4">4</a></li>
<li><a href="#5">5</a></li>
<li><a href="#6">6</a></li>
</ul>
</nav>
</div>
<div class="slide" id="5"><header><h2>Share with friends</h2>
</header>
<div class="content"><table>
<tr><td><img src="youmaxlisa.png"/></td><td><pre>
- Max:  Would be nice to see that phrase when I login as the message of the day
- You:  Easy peasy, just go install ... and run it.
- Lisa: Can we include it on the intranet?
- You:  Hmm.. (you pause and start thinking)
- You:  Not really; you could use the binary, but it would be slow with all the
        traffic we have</pre><p>Here you are faced with a decision on how to share
                the logic of generating a random rebelious
                statement.</p>
<ol>
<li>Redesign the logic as an importable package or</li>
<li>Write a small service with an API.</li>
<li>Share the data only and let them figure it out</li>
</ol>
<p>The first and second option will both require some
               effort. As the consumers are your friiends the first
               seems more fitting and much easier to do. The third
               option, though viable, does not help this presentation
               :-).</p>
</td></tr>
</table>
</div>
<nav><ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
<li><a href="#4">4</a></li>
<li class="current"><a href="#5">5</a></li>
<li><a href="#6">6</a></li>
</ul>
</nav>
</div>
<div class="slide" id="6"><header><h2>First attempt at redesign</h2>
</header>
<div class="content"><p>How do you convert the current state, a command, into an
        importable package while also keeping the command. First
        attempt; keep command in root and create a package with logic
        to generate the phrases.</p>
<pre class="shell dark">$ tree rebel<br/>rebel
├── go.mod
├── main.go
└── phrase
    └── phrase.go

1 directory, 3 files
</pre></div>
<nav><ul>
<li><a href="#1">1</a></li>
<li><a href="#2">2</a></li>
<li><a href="#3">3</a></li>
<li><a href="#4">4</a></li>
<li><a href="#5">5</a></li>
<li class="current"><a href="#6">6</a></li>
</ul>
</nav>
</div>
<script>function enhance() {
    // if there is no hash, start with the first slide
    var hash = window.location.hash;
    if (hash == "") {
	window.location += "#1"
	return
    }

    // handle clicks on slide changes
    window.onhashchange = toggleSlide;

    hash = hash.substring(1) // ignore the #
    var slides = document.getElementsByClassName("slide");
    for (var i = 0; i < slides.length; i++) {
	var s = slides.item(i);

	// hide all but the hashed one	
	if (s.id != hash) {
	    s.style.display = 'none';
	} else {
	    s.style.diplay = 'block';
	}
    }
}

var currentHash = window.location.hash;

function toggleSlide() {
    var c = document.getElementById(currentHash.substring(1));
    c.style.display = 'none';
    var n = document.getElementById(window.location.hash.substring(1))
    n.style.display = 'block';
    currentHash = window.location.hash;
}



enhance()
</script>
</body>
</html>
